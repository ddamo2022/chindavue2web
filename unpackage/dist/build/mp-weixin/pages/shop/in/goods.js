(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shop/in/goods"],{"18c9":function(e,t,n){"use strict";n.r(t);var o=n("62e1"),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},"1ac8":function(e,t,n){"use strict";(function(e,t){var o=n("47a9");n("b483");o(n("3240"));var r=o(n("4e47"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"4e47":function(e,t,n){"use strict";n.r(t);var o=n("5437"),r=n("18c9");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("a4de");var a=n("828b"),c=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,"1c412882",null,!1,o["a"],void 0);t["default"]=c.exports},5437:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$t("in_goods.privacy_policy_prompt")),o=e.$t("in_goods.privacy_desc"),r=e.$t("in_goods.privacy_agreement"),i=e.$t("in_goods.read_carefully"),a=e.$t("in_goods.login_and_order"),c=e.$t("in_goods.no_login_and_order");e._isMounted||(e.e0=function(t){e.wcshow=!1}),e.$mp.data=Object.assign({},{$root:{m0:n,m1:o,m2:r,m3:i,m4:a,m5:c}})},r=[]},"62e1":function(e,t,n){"use strict";(function(e,o){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("7eb4")),a=r(n("3b2d")),c=r(n("ee10")),s=r(n("7ca3")),d=n("8f59"),u=(n("cc12"),r(n("77a5"))),l=n("d468");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={components:{uniNavBar:function(){n.e("components/third/uni-nav-bar").then(function(){return resolve(n("c474"))}.bind(null,n)).catch(n.oe)},ChangeShop:function(){n.e("pages/shop/in/goods/gtop/change-shop").then(function(){return resolve(n("1472"))}.bind(null,n)).catch(n.oe)},NoLogin:function(){n.e("pages/shop/in/goods/gtop/login").then(function(){return resolve(n("d048"))}.bind(null,n)).catch(n.oe)},ShopNotice:function(){n.e("components/goods/shop-notice").then(function(){return resolve(n("7b39"))}.bind(null,n)).catch(n.oe)},Actions:function(){n.e("components/goods/actions/actions").then(function(){return resolve(n("b7fd"))}.bind(null,n)).catch(n.oe)},ProductModal:function(){Promise.all([n.e("common/vendor"),n.e("components/goods/product-modal/product-modal")]).then(function(){return resolve(n("30ec"))}.bind(null,n)).catch(n.oe)},CartBar:function(){n.e("components/goods/cartbar/cartbar").then(function(){return resolve(n("6f15"))}.bind(null,n)).catch(n.oe)},businessStatus:function(){n.e("pages/index/goods/business").then(function(){return resolve(n("cb3a"))}.bind(null,n)).catch(n.oe)},load:function(){n.e("components/common/load").then(function(){return resolve(n("1332"))}.bind(null,n)).catch(n.oe)},sqBtn:function(){Promise.all([n.e("common/vendor"),n.e("components/common/sq-btn")]).then(function(){return resolve(n("c52b"))}.bind(null,n)).catch(n.oe)},iDefault:function(){n.e("components/common/default").then(function(){return resolve(n("1c4b"))}.bind(null,n)).catch(n.oe)},gAd:function(){Promise.all([n.e("common/vendor"),n.e("components/drag/ad")]).then(function(){return resolve(n("a7cc"))}.bind(null,n)).catch(n.oe)},picLunboBy:function(){n.e("components/drag/picLunbo").then(function(){return resolve(n("7630"))}.bind(null,n)).catch(n.oe)},tcyhq:function(){Promise.all([n.e("common/vendor"),n.e("components/template/tcyhq")]).then(function(){return resolve(n("783a"))}.bind(null,n)).catch(n.oe)},gTable:function(){n.e("pages/shop/in/goods/g-table").then(function(){return resolve(n("674e"))}.bind(null,n)).catch(n.oe)},classTs1:function(){n.e("components/goods/template/class-ts1").then(function(){return resolve(n("c963"))}.bind(null,n)).catch(n.oe)},classTs2:function(){n.e("components/goods/template/class-ts2").then(function(){return resolve(n("0b0b"))}.bind(null,n)).catch(n.oe)},classTs3:function(){n.e("components/goods/template/class-ts3").then(function(){return resolve(n("be8f"))}.bind(null,n)).catch(n.oe)},classTs4:function(){n.e("components/goods/template/class-ts4").then(function(){return resolve(n("ba30"))}.bind(null,n)).catch(n.oe)},userPrivacy:function(){n.e("components/user/userPrivacy").then(function(){return resolve(n("50b8"))}.bind(null,n)).catch(n.oe)},mgPopup:function(){n.e("components/common/popup").then(function(){return resolve(n("c396"))}.bind(null,n)).catch(n.oe)},bindMobile:function(){n.e("components/common/bind-mobile").then(function(){return resolve(n("558f"))}.bind(null,n)).catch(n.oe)}},data:function(){return{privacyShow:!1,storeInfo:{},loading:!0,mainRef:null,categories:[],sIndex:0,rectInfoList:[],tempCurrent:0,scrollTop:0,product:{},ccId:0,notices:[],productModalVisible:!1,cartPopupShow:!1,pstop:0,showSearch:!1,showShopInfo:!1,goodsAd:[],swiper:{imgUrl:[],height:"260",circle:"30"},wcshow:!1,wcInfo:"",showTable:!1,addgood:0,navColor:"",navFontColor:"",navMenu:!0,categoryGoods:[]}},onReady:function(){var t=this;e.getPrivacySetting({success:function(e){e.needAuthorization&&t.$refs.privacy.open(e.privacyContractName)},fail:function(){},complete:function(e){console.log(e)}})},onShow:function(){this.isload&&this.refresh()},computed:g(g(g({},(0,d.mapState)(["sjxx","ingood"])),(0,d.mapState)({storeBasicSetting:function(e){return e.config.storeBasicSetting},orderSetting:function(e){return e.config.inStoreOrderConfig},scarList:function(e){return e.scarList.ins||[]},gs:function(e){return e.layout.goodStyle||{}}})),{},{ztqs:function(){return"rgba(".concat(this.cTR(this.tColor),",0.1)")},gcnum:function(){var e=this;return function(t){return e.scarList.goodsList.reduce((function(e,n){return n.spuId===t?e+n.num:e}),0)}}}),mixins:[l.utilMixins],onLoad:function(e){var t=this;return(0,c.default)(i.default.mark((function n(){var o,r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log("options",e),e&&e.q&&console.log("q",decodeURIComponent(e.q)),!e||!e.linecode){n.next=5;break}return n.next=5,t.checkLineCode(e.linecode);case 5:return e&&6==e.diningType&&e.storeId?(t.tableId=0,t.diningType=e.diningType,t.storeId=e.storeId):e.q&&decodeURIComponent(e.q).indexOf("diningType")>-1?(o=decodeURIComponent(e.q),t.tableId=0,t.diningType=u.default.getUrlParams(o)["diningType"],t.storeId=u.default.getUrlParams(o)["storeId"]):(r=u.default.getOptions(e,{key:"tableId"}),t.storeId=u.default.getOptions(e,{key:"storeId"}),t.tableId=r,e&&e.addgood&&(t.addgood=e.addgood)),t.query=e,t.util.setNT(t.$t("in_goods.scan_to_order")),t.loading=!0,console.log("tableId",t.tableId),console.log("storeId",t.storeId),n.next=13,t.load(t.tableId);case 13:t.showPrivacyInfo(),t.isLogin&&!t.user.mobile&&t.$refs["bindmobile"].open();case 15:case"end":return n.stop()}}),n)})))()},methods:g(g(g({},(0,d.mapActions)(["getSjxx","getConfig","getGoods","supInCar","getInCar","checkLineCode"])),(0,d.mapMutations)(["setGoods","setNoLogin","setToken"])),{},{load:function(e){var t=this;return(0,c.default)(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.tableId=e,n.next=3,t.getLoginInfo();case 3:return n.next=5,t.getLayout();case 5:return n.next=7,t.getDw();case 7:t.getConfig({ident:["storeBasicSetting","inStoreOrderConfig"]}),t.navFontColor=t.fontColor;case 9:case"end":return n.stop()}}),n)})))()},getDw:function(){var e=this;return(0,c.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:case"end":return t.stop()}}),t)})))()},openClick:function(){this.go({t:1,url:"/pages/my/other/gywm?t=用户协议&p=1"})},init:function(){var e=this;return(0,c.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.tableId){t.next=7;break}return t.next=3,e.getTable();case 3:return t.next=5,e.getGood();case 5:t.next=10;break;case 7:return e.storeInfo={id:e.storeId,diningType:e.diningType,tableInfo:{id:e.tableId,diningType:e.diningType}},t.next=10,e.getGood();case 10:case"end":return t.stop()}}),t)})))()},getTable:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n,o,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:"".concat(e.api.tsczxq,"/").concat(e.tableId),data:{lat:(null===(n=e.lc)||void 0===n?void 0:n.latitude)||"",lng:(null===(o=e.lc)||void 0===o?void 0:o.longitude)||""}});case 2:if(r=t.sent,!r){t.next=16;break}if(r.data.tableId=e.tableId,e.storeInfo={id:r.data.storeId,tableInfo:r.data,diningType:r.data.diningType},e.storeId=r.data.storeId,r.data.state||!(r.data.people<=0)||4!=r.data.diningType){t.next=11;break}e.showTable=!0,t.next=14;break;case 11:if(!r.data.orderSn||e.addgood){t.next=13;break}return t.abrupt("return",e.go({t:2,url:"/pages/order/detail?id=".concat(r.data.orderSn)}));case 13:e.gwc=setInterval((function(){var t,n;e.getInCar({storeId:e.storeId,tableId:e.tableId,diningType:e.storeInfo.diningType,lat:(null===(t=e.lc)||void 0===t?void 0:t.latitude)||"",lng:(null===(n=e.lc)||void 0===n?void 0:n.longitude)||""})}),3e3);case 14:t.next=18;break;case 16:return setTimeout((function(){e.go({t:6,url:"/pages/index/index"})}),2e3),t.abrupt("return");case 18:case"end":return t.stop()}}),t)})))()},getGood:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n,o,r,a;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.gs||2!=e.gs.goodsInStyle){t.next=5;break}return t.next=3,e.getCategory();case 3:t.next=6;break;case 5:e.getGoods({storeId:e.storeId,diningType:e.storeInfo.diningType,dType:"ins",tableId:e.tableId}).then((function(){e.categories=u.default.deepCopy(e.ingood),e.ccId=e.categories.length&&e.categories[0].id,e.$nextTick((function(){return e.$refs["classTs"].calcSize()})),e.havebxp=e.ingood.findIndex((function(e){return 1==e.isMust}))>-1,e.loading=!1})).catch((function(){e.loading=!1}));case 6:return e.getInCar({storeId:e.storeId,tableId:e.tableId,diningType:e.storeInfo.diningType,lat:(null===(n=e.lc)||void 0===n?void 0:n.latitude)||"",lng:(null===(o=e.lc)||void 0===o?void 0:o.longitude)||""}),t.next=9,e.getSjxx({storeId:e.storeId,lat:(null===(r=e.lc)||void 0===r?void 0:r.latitude)||"",lng:(null===(a=e.lc)||void 0===a?void 0:a.longitude)||""}).then((function(){6==e.storeInfo.diningType&&e.sjxx&&e.sjxx.inStoreSetting&&!e.sjxx.inStoreSetting.orderMode.includes(3)&&(e.util.message(e.$t("in_goods.number_calling_unavailable"),3,2e3),setTimeout((function(){e.go({t:6,url:"/pages/index/index"})}),2e3))}));case 9:e.storeId=e.sjxx.id,e.gAd(),e.getWc(),e.isload=!0;case 13:case"end":return t.stop()}}),t)})))()},nologin:function(){this.setNoLogin(),this.privacyShow=!1},showPrivacyInfo:function(){},linelogin:function(){var e=getCurrentPages().pop(),t="/".concat(e.route).concat(e.options?"?"+Object.keys(e.options).map((function(t){return"".concat(t,"=").concat(e.options[t])})).join("&"):"");console.log(t),o.setStorageSync("redirectPath",t),o.navigateTo({url:"/pages/other/login"})},getCategory:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:e.api.gInCategory,data:{storeId:e.storeId,diningType:e.diningType}});case 2:if(n=t.sent,o=n.data,!o||!o.length){t.next=13;break}return e.categories=o,e.havebxp=e.categories.findIndex((function(e){return 1==e.isMust}))>-1,e.ccId=o[0].id,e.setGoods({params:{storeId:e.storeId,dType:"ins"},data:o}),t.next=11,e.getCategoryGoods();case 11:t.next=14;break;case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t)})))()},getCategoryGoods:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:e.api.ingoods,data:{storeId:e.storeId,diningType:e.diningType,categoryId:e.ccId}});case 2:n=t.sent,o=n.data,e.categoryGoods=o||[],e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},refresh:function(){var e=this;return(0,c.default)(i.default.mark((function t(){return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getInCar({storeId:e.storeId,tableId:e.tableId,diningType:e.storeInfo.diningType});case 2:case"end":return t.stop()}}),t)})))()},tips:function(e){var t=this;o.showModal({title:this.$t("modal.title"),content:this.$t("in_goods.unable_to_get_table_info"),showCancel:!1,confirmText:i18n.t("modal.confirm"),success:function(e){t.go({t:6,url:"/pages/index/index"})}})},gAd:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n,o,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:e.api.gglb,data:{location:2,storeId:e.storeId}});case 2:if(n=t.sent,o=n.data,e.goodsAd=o?o.window:[],o.banner&&o.banner.length>0){for(r in o.banner)o.banner[r].url=o.banner[r].link;e.swiper={imgUrl:o.banner,height:"260",circle:"30"}}else e.swiper={imgUrl:[],height:"260",circle:"30"};case 6:case"end":return t.stop()}}),t)})))()},getWc:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:e.api.wc,data:{pos:2,storeId:e.storeId}});case 2:n=t.sent,o=n.data,o&&(e.wcInfo=o,setTimeout((function(){e.wcshow=!0}),400)),console.log("wc",o);case 6:case"end":return t.stop()}}),t)})))()},ljdc:function(e){var t=this;return(0,c.default)(i.default.mark((function n(){var o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.storeInfo.tableInfo.people=e,t.paIx=e,n.next=4,t.util.request({url:"".concat(t.api.inPeople,"/").concat(t.tableId),method:"PUT",data:{storeId:t.storeInfo.id,diningType:t.storeInfo.diningType,people:e}});case 4:o=n.sent,o.msg,t.showTable=!1,t.gwc=setInterval((function(){var e,n;t.getInCar({storeId:t.storeId,tableId:t.tableId,diningType:t.storeInfo.diningType,lat:(null===(e=t.lc)||void 0===e?void 0:e.latitude)||"",lng:(null===(n=t.lc)||void 0===n?void 0:n.longitude)||""})}),3e3);case 8:case"end":return n.stop()}}),n)})))()},handcar:function(e){var t=this;return(0,c.default)(i.default.mark((function n(){var o,r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("p",e),n.prev=1,n.next=4,t.supInCar({storeId:t.storeId,spuId:e.g.id,specMd5:e.g.specSwitch?e.g.specInfo&&e.g.specInfo.specMd5:e.g.specMd5||e.g.singleSpec.specMd5,attrData:e.g.specMd5?e.g.attrData||{}:e.g.specSwitch||e.g.attrSwitch||e.g.materialSwitch?{spec:e.g.specSwitch&&e.g.ggdata?e.g.ggdata:"",attr:e.g.attribute,matal:e.g.jldata,material:e.g.material}:{},num:e.addwz,lat:(null===(o=t.lc)||void 0===o?void 0:o.latitude)||"",lng:(null===(r=t.lc)||void 0===r?void 0:r.longitude)||"",tableId:t.tableId,diningType:t.storeInfo.diningType});case 4:n.sent,n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](1),console.log(n.t0);case 10:case"end":return n.stop()}}),n,null,[[1,7]])})))()},handdl:function(e){var t=this;return(0,c.default)(i.default.mark((function n(){var o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(e&&2==e.type||t.gs&&3==t.gs.goodsInDetail)){n.next=4;break}t.go({t:1,url:"/pages/shop/good-dl?goodId=".concat(e.id,"&storeId=").concat(t.storeId,"&diningType=").concat(t.storeInfo.diningType,"&tableId=").concat(t.tableId,"&dType=ins")}),n.next=10;break;case 4:return n.next=6,t.util.request({url:"".concat(t.api.ingoods,"/").concat(e.id),data:{storeId:t.storeId,diningType:t.storeInfo.diningType}});case 6:o=n.sent,t.product=o.data,t.productModalVisible=!0,t.$refs["productModal"].open(e,t.storeId,t.storeInfo.diningType);case 10:case"end":return n.stop()}}),n)})))()},handleAddToCartInModal:function(e){this.handcar(e),this.closeProductDetailModal()},closeProductDetailModal:function(){var e=this;this.productModalVisible=!1,this.$refs["productModal"].close(),setTimeout((function(){e.product={}}),100)},clearCart:function(){},handMenu:function(e,t){var n=this;this.gs&&2==this.gs.goodsInStyle?(this.ccId=e,this.getCategoryGoods()):(this.sIndex=t,this.pstop=this.categories.find((function(t){return t.id==e})).top,this.$nextTick((function(){return n.ccId=e})))},psroll:function(e){var t=this,n=e.detail,r=n.scrollTop;r>50?(this.navColor="transparent",this.navFontColor="#000",this.navMenu=!1):(this.navColor=this.tColor,this.navFontColor=this.fontColor,this.navMenu=!0);var i=this.categories.filter((function(e){return e.top<=r})).reverse();i.length>0&&(this.ccId=i[0].id),this.rectInfoList.forEach((function(e,n){r>=e.top&&r<=e.bottom&&(t.scrollTop=n*o.upx2px(100),t.sIndex=n)}))},rfcalc:function(e,t){this.rectInfoList=e,this.categories=t},calcSize:function(){var e=this,t=0,n=o.createSelectorQuery().select("#ads");n.fields({size:!0},(function(e){t+=Math.floor(e&&e.height)})).exec(),this.categories.forEach((function(n,r){var i=o.createSelectorQuery().select("#g-".concat(n.id));i.fields({size:!0,rect:!0},(function(o){n.top=t,t+=Math.floor(o.height),n.bottom=t,e.rectInfoList[r]={top:n.top,bottom:n.bottom}})).exec()}))},pay:function(){var e=this;return(0,c.default)(i.default.mark((function t(){var n,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.sjxx.inStoreSetting,!(n&&n.order&&2==n.order.payMode&&2==n.order.verification&&n.order.distance&&e.sjxx.distanceNum&&Number(e.sjxx.distanceNum)>Number(n.order.distance))){t.next=3;break}return t.abrupt("return",e.util.message(e.$t("in_goods.out_of_merchant_range"),3,2e3));case 3:if(!e.havebxp){t.next=7;break}if(o=function(){var t=e.ingood.filter((function(e){return 1==e.isMust})),n=0,o=e.scarList.goodsList.map((function(e){return e.spuId}));if(e.gs&&2==e.gs.goodsInStyle)for(var r=0;r<t.length;r++)e.scarList.categoryIds&&e.scarList.categoryIds.includes(t[r].id)&&(n+=1);else for(var i=0;i<t.length;i++)t[i].goodsList.find((function(e){return o.includes(e.id)}))&&(n+=1);if(n<t.length&&(!e.scarList.tables||e.scarList.tables&&!e.scarList.tables.orderSn))return{v:e.util.message(e.$t("in_goods.add_required_items"),3,1500)}}(),"object"!==(0,a.default)(o)){t.next=7;break}return t.abrupt("return",o.v);case 7:if(e.jjmbxx){t.next=17;break}return t.prev=8,t.next=11,e.requestSM(["integralChange","balanceChange","vipChange"]);case 11:t.next=17;break;case 13:return t.prev=13,t.t0=t["catch"](8),e.jjmbxx=!0,t.abrupt("return");case 17:e.gwc&&clearInterval(e.gwc),e.go({t:1,url:"/pages/shop/in/pay-order?tableId=".concat(e.tableId,"&diningType=").concat(e.storeInfo.diningType)});case 19:case"end":return t.stop()}}),t,null,[[8,13]])})))()},sqsjh:function(){this.$refs["sqBtn"].open()},handReturn:function(){this.go({t:5,url:"/pages/index/index"})}}),onUnload:function(){this.gwc&&clearInterval(this.gwc)}};t.default=p}).call(this,n("3223")["default"],n("df3c")["default"])},a4de:function(e,t,n){"use strict";var o=n("d65a"),r=n.n(o);r.a},d65a:function(e,t,n){}},[["1ac8","common/runtime","common/vendor"]]]);