(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shop/in/dmf"],{"4e65":function(e,n,t){},b166:function(e,n,t){"use strict";var o=t("4e65"),r=t.n(o);r.a},bd80:function(e,n,t){"use strict";(function(e,o){var r=t("47a9");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(t("7eb4")),s=r(t("7ca3")),c=r(t("ee10")),i=t("d468"),u=r(t("77a5")),f=t("8f59");function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){(0,s.default)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var p={components:{cuKeyboard:function(){t.e("components/cu-keyboard/cu-keyboard").then(function(){return resolve(t("5b1ac"))}.bind(null,t)).catch(t.oe)},sqBtn:function(){Promise.all([t.e("common/vendor"),t.e("components/common/sq-btn")]).then(function(){return resolve(t("c52b"))}.bind(null,t)).catch(t.oe)},Pay:function(){Promise.all([t.e("common/vendor"),t.e("components/pay/pay")]).then(function(){return resolve(t("1e12"))}.bind(null,t)).catch(t.oe)},notes:function(){Promise.all([t.e("common/vendor"),t.e("pages/shop/in/components/notes")]).then(function(){return resolve(t("f7b9"))}.bind(null,t)).catch(t.oe)},userPrivacy:function(){t.e("components/user/userPrivacy").then(function(){return resolve(t("50b8"))}.bind(null,t)).catch(t.oe)},sCoupon:function(){t.e("pages/shop/in/dmf/sCoupon").then(function(){return resolve(t("df880"))}.bind(null,t)).catch(t.oe)},Discounts:function(){t.e("pages/shop/in/dmf/discounts").then(function(){return resolve(t("d7fd"))}.bind(null,t)).catch(t.oe)}},data:function(){return{value:"",activeNum:1,isInputFocus:!1,show:!1,phone:"",money:"",params:{money:"",storeId:"",remarks:"",couponId:0},storeInfo:{},orderInfo:{}}},onReady:function(){var n=this;e.getPrivacySetting({success:function(e){e.needAuthorization&&n.$refs.privacy.open(e.privacyContractName)},fail:function(){},complete:function(e){console.log(e)}})},onLoad:function(e){var n=this;return(0,c.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("options",e),n.util.setNT(n.$t("dmf.pay_bill")),n.params.storeId=u.default.getOptions(e,{key:"storeId",q1:e.storeId}),t.next=5,n.getLoginInfo();case 5:return t.next=7,n.checkLogin();case 7:if(t.sent){t.next=9;break}return t.abrupt("return");case 9:n.init(),n.open();case 11:case"end":return t.stop()}}),t)})))()},mixins:[i.utilMixins],onShow:function(){o.getStorageSync("rStoreInfo")&&(this.storeInfo=o.getStorageSync("rStoreInfo"),this.params.storeId=this.storeInfo.id,this.load(this.storeInfo.id))},computed:l({},(0,f.mapState)({payCig:function(e){return e.config.personPayOrderConfig}})),methods:l(l({},(0,f.mapActions)(["getConfig"])),{},{load:function(e){var n=this;return(0,c.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e&&(o.removeStorageSync("rStoreInfo"),n.init());case 1:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return(0,c.default)(a.default.mark((function n(){var t,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.util.request({url:"".concat(e.api.mdxx,"/").concat(e.params.storeId)});case 2:t=n.sent,o=t.data,e.storeInfo=o.store,e.getConfig({ident:["personPayOrderConfig"]}),e.getCheckOut();case 7:case"end":return n.stop()}}),n)})))()},getCheckOut:function(){var e=this;return(0,c.default)(a.default.mark((function n(){var t,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.util.request({url:e.api.ppcheckout,data:{storeId:e.params.storeId,couponId:e.params.couponId,money:e.money}});case 2:t=n.sent,o=t.data,e.orderInfo=u.default.deepCopy(o);case 5:case"end":return n.stop()}}),n)})))()},change:function(e){this.money=e,console.log("e",this.money,e),this.getCheckOut()},open:function(){this.$refs.cukeyboard.open()},setNote:function(e){this.params.remarks=e},confirm:function(e){var n=this;return(0,c.default)(a.default.mark((function e(){var t,o;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n.payCig||1!=n.payCig.loginSwitch||n.isLogin){e.next=3;break}return n.$refs["sqBtn"].open(),e.abrupt("return");case 3:if(n.money){e.next=5;break}return e.abrupt("return",n.util.message(n.$t("dmf.please_enter_amount"),3));case 5:return n.params.money=n.money,n.loading=!0,n.$refs.cukeyboard.close(),e.next=10,n.util.request({url:n.api.mdxx,method:"POST",ct:1,mask:n.$t("dmf.ordering"),data:n.params});case 10:t=e.sent,o=t.data,o?o&&n.payCig&&2==n.payCig.balanceSwitch?n.$refs["Pay"].czOpen(JSON.stringify({orderSn:o.orderSn,orderType:3,go:{t:6,url:"/pages/index/order-index"}})):n.$refs["Pay"].open(JSON.stringify({orderSn:o.orderSn,orderType:3,go:{t:6,url:"/pages/index/order-index"}})):(n.loading=!1,n.getCheckOut());case 13:case"end":return e.stop()}}),e)})))()},goSelect:function(){o.navigateTo({url:"/pages/shop/select/index?page=recharge"})},addNote:function(){this.$refs["Notes"].open(this.params.notes)},selectCop:function(e){this.$refs["sCouponRef"].open(e)},sChangeClose:function(){},payorder:function(e){this.params.couponId=e?e.id:0,this.getCheckOut(),this.$refs["sCouponRef"].close()}})};n.default=p}).call(this,t("3223")["default"],t("df3c")["default"])},c906:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return o}));var o={pay:function(){return Promise.all([t.e("common/vendor"),t.e("components/pay/pay")]).then(t.bind(null,"1e12"))}},r=function(){var e=this,n=e.$createElement,t=(e._self._c,e.storeInfo&&e.storeInfo.id?e.$t("dmf.pay_to_merchant"):null),o=e.storeInfo&&e.storeInfo.id?e.$t("dmf.name"):null,r=e.storeInfo&&e.storeInfo.id?e.$t("dmf.amount"):null,a=e.storeInfo&&e.storeInfo.id&&!e.money?e.$t("dmf.enter_amount"):null,s=e.storeInfo&&e.storeInfo.id&&e.money&&e.orderInfo.discountMoney>0&&e.orderInfo.discountMoney?e.$t("dmf.total_discount"):null,c=e.storeInfo&&e.storeInfo.id&&e.money&&e.orderInfo.discountMoney>0?e.$t("dmf.actual_payment"):null,i=e.storeInfo&&e.storeInfo.id&&e.params.remarks?e.$t("dmf.remark"):null,u=e.storeInfo&&e.storeInfo.id&&e.params.remarks?e.$t("dmf.modify"):null,f=e.storeInfo&&e.storeInfo.id&&!e.params.remarks?e.$t("dmf.add_remark"):null;e.$mp.data=Object.assign({},{$root:{m0:t,m1:o,m2:r,m3:a,m4:s,m5:c,m6:i,m7:u,m8:f}})},a=[]},cd68:function(e,n,t){"use strict";(function(e,n){var o=t("47a9");t("b483");o(t("3240"));var r=o(t("df98"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(r.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},df98:function(e,n,t){"use strict";t.r(n);var o=t("c906"),r=t("e041");for(var a in r)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(a);t("b166");var s=t("828b"),c=Object(s["a"])(r["default"],o["b"],o["c"],!1,null,"6d827590",null,!1,o["a"],void 0);n["default"]=c.exports},e041:function(e,n,t){"use strict";t.r(n);var o=t("bd80"),r=t.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(a);n["default"]=r.a}},[["cd68","common/runtime","common/vendor"]]]);