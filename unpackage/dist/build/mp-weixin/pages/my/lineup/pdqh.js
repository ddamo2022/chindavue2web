(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/lineup/pdqh"],{"15f3":function(e,t,n){"use strict";n.r(t);var r=n("bb27"),a=n("d4c3");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("ea84");var s=n("828b"),u=Object(s["a"])(a["default"],r["b"],r["c"],!1,null,"c50feb80",null,!1,r["a"],void 0);t["default"]=u.exports},4853:function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("b483");r(n("3240"));var a=r(n("15f3"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},5150:function(e,t,n){},b315:function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),o=r(n("7ca3")),s=r(n("ee10")),u=n("8f59"),i=r(n("77a5")),c=n("cc12"),l=n("d468");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={name:"pdqh",components:{mgInput:function(){n.e("components/form/my-input").then(function(){return resolve(n("4624"))}.bind(null,n)).catch(n.oe)},wPicker:function(){Promise.all([n.e("common/vendor"),n.e("components/form/w-picker")]).then(function(){return resolve(n("a5b8"))}.bind(null,n)).catch(n.oe)},bookText:function(){Promise.all([n.e("common/vendor"),n.e("components/common/functionCmp/rich-text")]).then(function(){return resolve(n("248b"))}.bind(null,n)).catch(n.oe)},navTab:function(){n.e("components/common/functionCmp/nav-tab").then(function(){return resolve(n("1b29"))}.bind(null,n)).catch(n.oe)},MgCell:function(){n.e("components/common/my-cell").then(function(){return resolve(n("193e"))}.bind(null,n)).catch(n.oe)},OrderList:function(){n.e("pages/my/lineup/components/order-list").then(function(){return resolve(n("d384"))}.bind(null,n)).catch(n.oe)},sqBtn:function(){Promise.all([n.e("common/vendor"),n.e("components/common/sq-btn")]).then(function(){return resolve(n("c52b"))}.bind(null,n)).catch(n.oe)},iDefault:function(){n.e("components/common/default").then(function(){return resolve(n("1c4b"))}.bind(null,n)).catch(n.oe)}},data:function(){return{czInfo:{},bqarr:[],aIdx:0,telcode:"+66",qparams:{people:"",type_id:"",peopleText:"",contact:""},pArr:[],loading:!1,tIdx:0,tabs:[{name:this.$t("lineup.queue_for_number")},{name:this.$t("lineup.my_queue")}],labelArr:[],tntabs:[{name:this.$t("lineup.queue"),type:5}],dataList:[],laIdx:0,isget:!1,mygd:!1,params:{size:10,page:1},storeInfo:{},storeId:"",refreshLoading:!0,status:"loading"}},onLoad:function(e){var t=this;return(0,s.default)(a.default.mark((function n(){var r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.query=e,!e||!e.storeId){n.next=6;break}t.storeId=e.storeId,t.storeInfo.id=e.storeId,n.next=19;break;case 6:if(!(e.q&&decodeURIComponent(e.q).indexOf("storeId")>-1)){n.next=12;break}r=decodeURIComponent(e.q),t.storeId=i.default.getUrlParams(r)["storeId"],t.storeInfo.id=t.storeId,n.next=19;break;case 12:if(!e||!e.id){n.next=17;break}t.storeId=e.id,t.storeInfo.id=e.id,n.next=19;break;case 17:return n.next=19,t.gDw();case 19:t.util.setNT(t.$t("lineup.queue_for_number")),t.init(),console.log("--1212",t.user),t.user.mobile&&(t.qparams.contact=t.user.mobile.replace(/^(\+66|66)/,""));case 23:case"end":return n.stop()}}),n)})))()},onShow:function(){var t=this;return(0,s.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.getStorageSync("rStoreInfo")&&(t.storeInfo=e.getStorageSync("rStoreInfo"),t.load(t.storeInfo.id));case 1:case"end":return n.stop()}}),n)})))()},mixins:[l.utilMixins],computed:f({},(0,u.mapState)(["sjxx"])),methods:f(f({},(0,u.mapActions)(["getConfig","getSjxx"])),{},{init:function(){var e=this;return(0,s.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getLoginInfo();case 2:return t.next=4,e.checkLogin();case 4:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:return e.getLayout(),t.next=9,e.getSjxx({storeId:e.storeInfo&&e.storeInfo.id,lat:e.lc&&e.lc.latitude||"",lng:e.lc&&e.lc.longitude||""}).then((function(){e.storeInfo=e.sjxx,e.sjxx&&e.sjxx.queueingSetting&&1!=e.sjxx.queueingSetting.qSwitch&&e.util.message(e.$t("lineup.store_queue_closed"),3,2e3)}));case 9:e.getData();case 10:case"end":return t.stop()}}),t)})))()},load:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t&&e.removeStorageSync("rStoreInfo"),n.init();case 2:case"end":return r.stop()}}),r)})))()},gDw:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var n,r;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.storeInfo||!e.storeInfo.id){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,(0,c.getDw)({t:0});case 6:return n=t.sent,e.lc=n,t.next=10,e.getAddInfo(n);case 10:return t.next=12,e.util.request({url:e.api.dplb,data:{lat:n.latitude||"",lng:n.longitude||"",recharge:1}});case 12:r=t.sent,e.storeInfo=r.data&&r.data.list&&r.data.list[0];case 14:case"end":return t.stop()}}),t)})))()},goSelect:function(){e.navigateTo({url:"/pages/shop/select/index?page=recharge"})},changeTab:function(e){this.laIdx=0,this.isget=this.mygd=!1,this.params.page=1,1==this.tIdx&&(this.labelArr=[],this.params.api="pdlb",this.iparams={},this.dataList=[],this.getList())},onPulling:function(e){},onRefresh:function(){var e=this;this.freshing||(this.freshing=!0,setTimeout((function(){e.refresh(),e.refreshLoading=!1,e.freshing=!1}),500))},onRestore:function(){this.refreshLoading="restore",console.log("onRestore")},onAbort:function(){},getList:function(e){var t=this;return(0,s.default)(a.default.mark((function n(){var r,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.status="loading",n.next=3,t.util.request({url:t.api.pdxd,data:t.params});case 3:if(r=n.sent,o=r.data.list,"nextPage"===e&&1!==t.params.page){n.next=9;break}t.dataList=o,n.next=13;break;case 9:if(0!==o.length){n.next=12;break}return t.status="nomore",n.abrupt("return");case 12:t.dataList=t.dataList.concat(o);case 13:t.status="loadmore";case 14:case"end":return n.stop()}}),n)})))()},refresh:function(){var e=this;return(0,s.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=1,t.next=3,e.getList();case 3:case"end":return t.stop()}}),t)})))()},nextPage:function(){"loading"!==this.status&&(this.params.page++,this.getList("nextPage"))},operation:function(e){var t=this;return(0,s.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.orderInfo=e.co,t.operationt=e.t,{},n.t0=e.t,n.next="qxpd"===n.t0?6:8;break;case 6:return t.rfddcz(t.$t("lineup.confirm_cancel_queue"),"pdxd",e.co.id),n.abrupt("break",8);case 8:case"end":return n.stop()}}),n)})))()},rfddcz:function(e,t,n){var r=this;return(0,s.default)(a.default.mark((function o(){var s,u;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,r.util.modal(e);case 2:return a.next=4,r.util.request({url:"".concat(r.api[t],"/").concat(n),method:"DELETE"});case 4:s=a.sent,u=s.msg,r.util.message(u,1,1e3),r.refresh();case 8:case"end":return a.stop()}}),o)})))()},getData:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var n,r,o,s;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:e.api.pdcz,data:{storeId:e.storeInfo&&e.storeInfo.id}});case 2:for(n=t.sent,r=n.data,e.czInfo=r||[],console.log("121243",e.czInfo[0]),o=30,e.czInfo&&e.czInfo.length>0&&(o=e.czInfo[0].maxNum),s=1;s<=o;s++)e.pArr.push({label:s,value:s});case 8:case"end":return t.stop()}}),t)})))()},toggleTab:function(e){this.$refs[e].show()},onConfirm:function(e,t){switch(console.log(t),console.log(this.qparams),console.log(e.result),t){case"people":this.qparams[t]=e.result,this.qparams.peopleText=e.result+this.$t("goods.people");break}},clickMode:function(e,t){console.log(t),this.aIdx=t,console.log(e),this.qparams.type_id=e.id;var n=30;e&&(n=e.maxNum),this.pArr=[];for(var r=1;r<=n;r++)this.pArr.push({label:r,value:r})},save:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var n,r,o,s;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isLogin){t.next=2;break}return t.abrupt("return",e.$refs["sqBtn"].open());case 2:if(!e.sjxx||!e.sjxx.queueingSetting||1==e.sjxx.queueingSetting.qSwitch){t.next=5;break}return console.log("1212"),t.abrupt("return",e.util.message(e.$t("lineup.store_queue_closed"),3,2e3));case 5:if(e.qparams.type_id||(e.qparams.type_id=e.czInfo&&e.czInfo[0]?e.czInfo[0].id:""),console.log(e.qparams),e.qparams.storeId=e.storeInfo&&e.storeInfo.id,n=[],r=i.default.isFailParams({field:e.qparams,filter:n,tips:{type_id:e.$t("lineup.please_select_valid_people_based_on_table_type"),people:e.$t("lineup.please_select_people"),contact:e.$t("lineup.please_fill_in_phone_number")}}),r){t.next=14;break}return t.abrupt("return");case 14:if(i.default.isTelCode(e.qparams.contact)){t.next=16;break}return t.abrupt("return",e.util.message(e.$t("lineup.please_enter_correct_phone_number"),3));case 16:return console.log(e.qparams),e.loading=!0,o=e.qparams.contact,o=e.qparams.contact.startsWith("+66")?e.qparams.contact:e.qparams.contact.startsWith("66")?"+66"+e.qparams.contact.slice(2):"+66"+e.qparams.contact,e.qparams.contact=o,t.next=23,e.util.request({url:e.api.pdxd,method:"POST",mask:1,data:e.qparams});case 23:s=t.sent,s?(e.util.message(s.msg,1,1e3),e.loading=!1,e.qparams.people=0,e.qparams.peopleText="",i.default.stfn((function(){e.go({t:1,url:"/pages/my/lineup/pdxq?id="+s.data})}))):(e.loading=!1,e.qparams.contact=e.qparams.contact.replace(/^(\+66|66)/,""));case 25:case"end":return t.stop()}}),t)})))()}})};t.default=d}).call(this,n("df3c")["default"])},bb27:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,n=(e._self._c,0==e.tIdx?e.$t("lineup.table_type"):null),r=0==e.tIdx?e.$t("lineup.waiting_tables"):null,a=0==e.tIdx?e.$t("lineup.estimated_waiting"):null,o=0==e.tIdx?e.__map(e.czInfo,(function(t,n){var r=e.__get_orig(t),a=e.$t("goods.people"),o=e.$t("lineup.table"),s=t.queuingUp&&t.queuingUp.minutes>0?e.$t("lineup.minutes"):null,u=t.queuingUp&&t.queuingUp.minutes>0?null:e.$t("lineup.no_waiting");return{$orig:r,m3:a,m4:o,m5:s,m6:u}})):null,s=0==e.tIdx?e.$t("lineup.dining_people"):null,u=0==e.tIdx?e.$t("lineup.please_select"):null,i=0==e.tIdx?e.$t("lineup.table_type"):null,c=0==e.tIdx?e.czInfo.length:null,l=0!=e.tIdx||c?null:e.$t("lineup.please_select_people_based_on_table_type"),p=0==e.tIdx?e.czInfo.length:null,f=0==e.tIdx&&p?e.__map(e.czInfo,(function(t,n){var r=e.__get_orig(t),a=e.$t("lineup.estimated_waiting"),o=e.$t("lineup.table"),s=e.$t("lineup.minutes");return{$orig:r,m11:a,m12:o,m13:s}})):null,d=0==e.tIdx?e.$t("lineup.phone_number"):null,m=0==e.tIdx?e.$t("lineup.please_enter_phone_number"):null,g=0==e.tIdx?e.$t("lineup.confirm_take_number"):null,h=1==e.tIdx?!e.dataList||e.dataList.length<=0:null;e.$mp.data=Object.assign({},{$root:{m0:n,m1:r,m2:a,l0:o,m7:s,m8:u,m9:i,g0:c,m10:l,g1:p,l1:f,m14:d,m15:m,m16:g,g2:h}})},a=[]},d4c3:function(e,t,n){"use strict";n.r(t);var r=n("b315"),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},ea84:function(e,t,n){"use strict";var r=n("5150"),a=n.n(r);a.a}},[["4853","common/runtime","common/vendor"]]]);