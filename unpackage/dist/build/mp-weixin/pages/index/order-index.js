(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/order-index"],{"055f":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var r={pay:function(){return Promise.all([n.e("common/vendor"),n.e("components/pay/pay")]).then(n.bind(null,"1e12"))}},a=function(){var e=this.$createElement,t=(this._self._c,!this.list||this.list.length<=0);this.$mp.data=Object.assign({},{$root:{g0:t}})},o=[]},"0e5a":function(e,t,n){"use strict";n.r(t);var r=n("a786"),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},"34c4":function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("b483");r(n("3240"));var a=r(n("40fd"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"40fd":function(e,t,n){"use strict";n.r(t);var r=n("055f"),a=n("0e5a");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("87aa");var u=n("828b"),i=Object(u["a"])(a["default"],r["b"],r["c"],!1,null,"7f43ae60",null,!1,r["a"],void 0);t["default"]=i.exports},"87aa":function(e,t,n){"use strict";var r=n("ed8c"),a=n.n(r);a.a},a786:function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),o=r(n("7ca3")),u=r(n("ee10")),i=n("e19d"),s=n("8f59");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={components:{OrderList:function(){Promise.all([n.e("common/vendor"),n.e("pages/index/order/order-list")]).then(function(){return resolve(n("ed32"))}.bind(null,n)).catch(n.oe)},Pay:function(){Promise.all([n.e("common/vendor"),n.e("components/pay/pay")]).then(function(){return resolve(n("1e12"))}.bind(null,n)).catch(n.oe)},load:function(){n.e("components/common/load").then(function(){return resolve(n("1332"))}.bind(null,n)).catch(n.oe)},iDefault:function(){n.e("components/common/default").then(function(){return resolve(n("1c4b"))}.bind(null,n)).catch(n.oe)}},data:function(){return{showloading:!0,tabs:[{value:"inStore",name:this.$t("order-index.store_order")},{value:"storedValue",name:this.$t("order-index.stored_value_order")},{value:"persionPay",name:this.$t("order-index.pay_the_bill_order")},{value:"couponPack",name:this.$t("order-index.coupon_package_order")}],taIdx:0,tabIndex:0,orderMenuIndex:0,orders:[],storeOrders:[],refreshLoading:!0,status:"loading",list:[],params:{page:1,size:10,state:"inStore"}}},onLoad:function(e){var t=this;return(0,u.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.init(),t.freshing=!1,n.next=4,t.$store.dispatch("getLoginInfo");case 4:if(!e||!e.linetype){n.next=7;break}return n.next=7,t.iniline();case 7:case"end":return n.stop()}}),n)})))()},onShow:function(){this.isload&&this.refresh()},computed:d(d({},(0,s.mapState)({layout:function(e){return e.layout.index||{}},defaultImg:function(e){return e.layout.defaultImg||[]}})),{},{batchInvoiceVisible:function(){return!this.orderMenuIndex&&this.orders.length||this.orderMenuIndex&&this.storeOrders.length}}),methods:d(d({},(0,s.mapActions)(["getConfig"])),{},{init:function(){var e=this;return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getLayout();case 2:return t.next=4,e.fetchData();case 4:e.isload=!0,e.getConfig({ident:["orderSetting"]}),e.showloading=!1;case 7:case"end":return t.stop()}}),t)})))()},onPulling:function(e){},onRefresh:function(){var e=this;this.freshing||(this.freshing=!0,setTimeout((function(){e.refresh(),e.refreshLoading=!1,e.freshing=!1}),500))},onRestore:function(){this.refreshLoading="restore",console.log("onRestore")},onAbort:function(){},iniline:function(){var e=this;return(0,u.default)(a.default.mark((function t(){var n,r;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e,e.$store.state.isLogin||(r=getApp().globalData.siteInfo.liffId,n=e,(0,i.loadLineSDK)(r).then(function(){var e=(0,u.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t.isLoggedIn()),!t){e.next=7;break}if(!t.isLoggedIn()){e.next=6;break}return e.abrupt("return",t.getProfile());case 6:return e.abrupt("return",t.login({redirectUri:window.location.href}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var e=(0,u.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t||!t.userId){e.next=3;break}return e.next=3,n.linelogin(t.userId,t.displayName);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e)})));case 2:case"end":return t.stop()}}),t)})))()},linelogin:function(e,t){var n=this;return(0,u.default)(a.default.mark((function r(){var o;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.util.request({url:n.api.lineLogin,method:"post",data:{id:e,name:t}});case 2:o=r.sent,o.data&&(n.$store.commit("setUser",o.data.userInfo),n.$store.commit("setToken",o.data.token));case 4:case"end":return r.stop()}}),r)})))()},fetchData:function(t){var n=this;return(0,u.default)(a.default.mark((function r(){var o,u,i;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=e.getStorageSync("nologin_orderid"),!n.user.id&&o&&(n.params.orderid=o),n.status="loading",r.next=5,n.util.request({url:n.api.wmxd,data:n.params});case 5:if(u=r.sent,i=u.data.list,"nextPage"===t&&1!==n.params.page){r.next=11;break}n.list=i,r.next=15;break;case 11:if(0!==i.length){r.next=14;break}return n.status="nomore",r.abrupt("return");case 14:n.list=n.list.concat(i);case 15:n.status="loadmore";case 16:case"end":return r.stop()}}),r)})))()},refresh:function(){var e=this;return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=1,t.next=3,e.fetchData();case 3:case"end":return t.stop()}}),t)})))()},nextPage:function(){"loading"!==this.status&&(this.params.page++,this.fetchData("nextPage"))},tClick:function(e,t){var n=this;return(0,u.default)(a.default.mark((function r(){return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e!=n.taIdx){r.next=2;break}return r.abrupt("return");case 2:n.taIdx=e,n.params.state=t.value,n.refresh();case 5:case"end":return r.stop()}}),r)})))()},operation:function(e){var t=this;return(0,u.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.orderInfo=e.co,t.operationt=e.t,{},n.t0=e.t,n.next="ljzf"===n.t0?6:"qxdd"===n.t0?8:"sqtk"===n.t0?10:"zlyd"===n.t0?14:16;break;case 6:return t.$refs["Pay"].open(JSON.stringify({orderSn:e.co.orderSn,orderType:1})),n.abrupt("break",16);case 8:return t.rfddcz(t.$t("order-index.confirm_cancel_order"),"qxdd",e.co.id),n.abrupt("break",16);case 10:return n.next=12,t.util.modal(t.$t("order-index.confirm_apply_refund"));case 12:return t.go({t:1,url:"/pages/order/refunddl?id=".concat(e.co.orderSn,"&type=1")}),n.abrupt("break",16);case 14:return t.go({t:6,url:"/pages/index/goods"}),n.abrupt("break",16);case 16:case"end":return n.stop()}}),n)})))()},rfddcz:function(e,t,n){var r=this;return(0,u.default)(a.default.mark((function o(){var u,i;return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,r.util.modal(e);case 2:if(r.jjmbxx){a.next=12;break}return a.prev=3,a.next=6,r.requestSM(["refund"]);case 6:a.next=12;break;case 8:return a.prev=8,a.t0=a["catch"](3),r.jjmbxx=!0,a.abrupt("return");case 12:return a.next=14,r.util.request({url:"".concat(r.api[t],"/").concat(n),method:"POST"});case 14:u=a.sent,i=u.msg,r.util.message(i,1,1e3),r.refresh();case 18:case"end":return a.stop()}}),o,null,[[3,8]])})))()},pay:function(){this.refresh()},handleSwiperItemChange:function(){return!0},switchMenuTab:function(e){var t=this;return(0,u.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.orderMenuIndex!==e){n.next=2;break}return n.abrupt("return");case 2:return t.orderMenuIndex=e,n.next=5,t.getOrders();case 5:case"end":return n.stop()}}),n)})))()}})};t.default=f}).call(this,n("df3c")["default"])},ed8c:function(e,t,n){}},[["34c4","common/runtime","common/vendor"]]]);