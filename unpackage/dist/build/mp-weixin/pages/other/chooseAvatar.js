(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/other/chooseAvatar"],{"2c34":function(e,t,a){"use strict";a.r(t);var r=a("ffaf"),n=a("a72d");for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("73e8");var o=a("828b"),i=Object(o["a"])(n["default"],r["b"],r["c"],!1,null,"4630b03d",null,!1,r["a"],void 0);t["default"]=i.exports},"38ce":function(e,t,a){"use strict";(function(e){var r=a("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("7eb4")),s=r(a("7ca3")),o=r(a("ee10")),i=a("8f59"),u=r(a("77a5")),c=r(a("5137")),l=a("d468");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f={components:{sqBtn:function(){Promise.all([a.e("common/vendor"),a.e("components/common/sq-btn")]).then(function(){return resolve(a("c52b"))}.bind(null,a)).catch(a.oe)},mgRadio:function(){a.e("components/form/my-radio").then(function(){return resolve(a("2c44"))}.bind(null,a)).catch(a.oe)}},name:"chooseAcatar",data:function(){return{loading:!1,avatarUrl:"https://thirdwx.qlogo.cn/mmopen/vi_32/POgEwh4mIHO4nibH0KlMECNjjGxQUq24ZEaGT4poC6icRiccVGKSyXwibcPq4BWmiaIGuG1icwxaQX6grC9VemZoJ8rg/132",baseData:"",nickname:"",userId:"",userMobile:"",isuserMobile:!1,email:"",time:0,btntxt:this.$t("chooseAvatar.send_verification_code"),isSending:!1,params:{userId:"",userTel:"",email:"",birthday:"2000-01-01",sex:this.$t("chooseAvatar.male"),realName:"",createdAt:""},sexArr:[{value:1,name:this.$t("chooseAvatar.male")},{value:2,name:this.$t("chooseAvatar.female"),checked:"true"}],birthday:""}},onLoad:function(){var e=this;return(0,o.default)(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.util.setNT(e.$t("chooseAvatar.personal_info")),e.user&&(e.avatarUrl=e.user.avatar,e.nickname=e.user.nickname,e.userId=e.user.id,e.user.mobile&&e.user.mobile.length>0&&(e.userMobile=e.user.mobile,e.isuserMobile=!0),e.params.userTel=e.user.mobile,e.params.email=e.user.email,e.params.realName=e.user.realName,e.params.sex=e.user.sex?e.user.sex:1,e.user.birthday&&e.isValidDateTime(e.user.birthday)&&(console.log("1--12",e.user.birthday),e.params.birthday=e.user.birthday,e.birthday=e.user.birthday)),e.getConfig({ident:["basicSetting","birthdayGift"]});case 3:case"end":return t.stop()}}),t)})))()},computed:d(d({},(0,i.mapState)({system:function(e){return e.system},birthdayGift:function(e){return e.config.birthdayGift}})),{},{hToken:function(){return"Bearer ".concat(e.getStorageSync("token"))},appType:function(){return c.default.platform},startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}}),mixins:[l.utilMixins],methods:d(d(d({},(0,i.mapActions)(["getConfig"])),(0,i.mapMutations)(["setMobile","setToken","setUser"])),{},{onChooseAvatar:function(e){console.log("e",e),this.avatarUrl=e.detail.avatarUrl},isValidDateTime:function(e){var t=new Date(e);return t instanceof Date&&!isNaN(t)},onInput:function(e){console.log(e),this.nickname=e.detail.value},sqsjh:function(){this.$refs["sqBtn"].open()},bindDateChange:function(e){var t=this;return(0,o.default)(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log(e),t.params.birthday=e.target.value;case 2:case"end":return a.stop()}}),a)})))()},getDate:function(e){var t=new Date,a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate();return"start"===e?a-=60:"end"===e&&(a+=2),r=r>9?r:"0"+r,n=n>9?n:"0"+n,"".concat(a,"-").concat(r,"-").concat(n)},timer:function(){this.time>0?(this.time--,this.btntxt=this.time+this.$t("sq-btn.seconds"),setTimeout(this.timer,1e3)):(this.time=0,this.btntxt=this.$t("sq-btn.send_verification_code"))},sendcode:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var a,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.params.userTel.length<7)){t.next=2;break}return t.abrupt("return",e.util.message(e.$t("registration.enter_phone_number"),3));case 2:return a=e.params.userTel,a=e.params.userTel.startsWith("+66")?e.params.userTel:e.params.userTel.startsWith("66")?"+66"+e.params.userTel.slice(2):"+66"+e.params.userTel,e.isSending=!0,t.next=7,e.util.request({url:e.api.sendRegisterCode,method:"POST",mask:e.$t("password_reset.sending"),data:{phone:a,type:1}});case 7:r=t.sent,e.isSending=!1,console.log("1212",r),r&&200==r.code&&(e.time=60,e.timer());case 11:case"end":return t.stop()}}),t)})))()},cmb:function(t){var a=this;return(0,o.default)(n.default.mark((function r(){var s,i,c;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log("mpGetphonenumber",t),"getPhoneNumber:ok"!=t.detail.errMsg){r.next=8;break}a.loading=!0,s=getApp().globalData.session_key,i=t.detail.encryptedData,c=t.detail.iv,a.util.request({url:a.api.jm,method:"POST",data:{sessionKey:s,data:i,iv:c}}).then(function(){var t=(0,o.default)(n.default.mark((function t(r){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a.loading=!1,!r.data.phoneNumber){t.next=9;break}return a.setMobile(r.data.phoneNumber),e.setStorageSync("userTel",r.data.phoneNumber),t.next=6,a.util.request({url:a.api.gxmb,method:"post",data:{mobile:r.data.phoneNumber}}).then(function(){var e=(0,o.default)(n.default.mark((function e(t){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("rest",t),a.setToken(t.data.token),a.setUser(t.data.userInfo),a.util.message(t.msg||a.$t("chooseAvatar.registration_successful"),1,1e3),u.default.swnb(1e3);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){a.loading=!1}));case 6:t.sent,t.next=10;break;case 9:console.log(r);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){a.loading=!1})),console.log(s,i,c),r.next=11;break;case 8:return a.loading=!1,e.showModal({title:a.$t("chooseAvatar.warm_reminder"),content:a.$t("chooseAvatar.authorized_mobile_number_failed"),showCancel:!1,confirmText:i18n.t("modal.confirm")}),r.abrupt("return");case 11:case"end":return r.stop()}}),r)})))()},goLogin:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var a;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.params.userTel){t.next=3;break}return e.util.message(e.$t("chooseAvatar.please_authorize_mobile_number"),3,2e3),t.abrupt("return");case 3:if(e.params.birthday){t.next=6;break}return e.util.message(e.$t("chooseAvatar.please_birthday"),3,2e3),t.abrupt("return");case 6:return a=e.params.userTel,a=e.params.userTel.startsWith("+66")?e.params.userTel:e.params.userTel.startsWith("66")?"+66"+e.params.userTel.slice(2):"+66"+e.params.userTel,t.next=10,e.refreshUser({get:0,now:1,mobile:a,avatar:e.avatarUrl,nickname:e.nickname,realName:e.params.realName?e.params.realName:"",sex:e.params.sex,birthday:e.params.birthday,code:e.params.code,email:e.params.email});case 10:e.util.message(e.$t("chooseAvatar.modification_successful"),1,1e3),e.refreshUser({get:1,now:1}),u.default.swnb(1e3);case 13:case"end":return t.stop()}}),t)})))()},outLogin:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var a,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.modal(e.$t("chooseAvatar.confirm_logout"));case 2:return t.next=4,e.util.request({url:e.api.logout,method:"POST"});case 4:return a=t.sent,r=a.msg,e.util.message(r,1,1e3),t.next=9,e.setUser({id:"",mobile:""});case 9:return t.next=11,e.setToken("");case 11:e.getLoginInfo(),u.default.swnb(1e3);case 13:case"end":return t.stop()}}),t)})))()},handleAvatarSuccess2:function(e){this.avatarUrl=e.data},ckxz:function(){this.go({t:1,url:"/pages/my/other/gywm?t=活动说明&p=7"})},ckzl:function(){this.go({t:1,url:"/pages/my/other/gywm?t=活动说明&p=8"})},djsr:function(){this.util.message(this.$t("chooseAvatar.birthday_cannot_be_modified"),3,2e3)}})};t.default=f}).call(this,a("df3c")["default"])},"49e6":function(e,t,a){"use strict";(function(e,t){var r=a("47a9");a("b483");r(a("3240"));var n=r(a("2c34"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(n.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])},"73e8":function(e,t,a){"use strict";var r=a("c757"),n=a.n(r);n.a},a72d:function(e,t,a){"use strict";a.r(t);var r=a("38ce"),n=a.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(s);t["default"]=n.a},c757:function(e,t,a){},ffaf:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,a=(e._self._c,e.user.vipCard?null:e.cTR(e.tColor)),r=e.user.vipCard?null:e.$t("chooseAvatar.membership_card"),n=e.$t("chooseAvatar.user"),s=e.$t("chooseAvatar.user_nickname"),o=e.$t("chooseAvatar.enter_user_nickname"),i=e.$t("chooseAvatar.mobile_number"),u=e.$t("chooseAvatar.enter_mobile"),c=e.isuserMobile?null:e.$t("chooseAvatar.requestopt"),l=e.isuserMobile||e.time<=0?null:e.$t("sq-btn.sent"),m=e.isuserMobile?null:e.$t("chooseAvatar.enteropt"),d=e.isuserMobile?null:e.$t("chooseAvatar.enter_code"),f=e.$t("chooseAvatar.email"),h=e.$t("chooseAvatar.enter_email"),p=e.$t("chooseAvatar.real_name"),b=e.$t("chooseAvatar.enter_realName"),v=e.$t("chooseAvatar.gender"),g=e.$t("chooseAvatar.birthday"),y=e.birthday?null:e.params.birthday||e.$t("chooseAvatar.birthday_once_modified")+"，"+e.$t("chooseAvatar.cannot_edit_again"),_=e.$t("chooseAvatar.save"),w=e.$t("chooseAvatar.log_out");e.$mp.data=Object.assign({},{$root:{m0:a,m1:r,m2:n,m3:s,m4:o,m5:i,m6:u,m7:c,m8:l,m9:m,m10:d,m11:f,m12:h,m13:p,m14:b,m15:v,m16:g,m17:y,m18:_,m19:w}})},n=[]}},[["49e6","common/runtime","common/vendor"]]]);