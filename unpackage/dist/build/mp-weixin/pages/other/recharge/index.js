(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/other/recharge/index"],{"0f64":function(e,r,t){},"1fc2":function(e,r,t){"use strict";t.r(r);var n=t("e088"),a=t("981a");for(var c in a)["default"].indexOf(c)<0&&function(e){t.d(r,e,(function(){return a[e]}))}(c);t("2d34f");var u=t("828b"),o=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"7cb33451",null,!1,n["a"],void 0);r["default"]=o.exports},"2d34f":function(e,r,t){"use strict";var n=t("0f64"),a=t.n(n);a.a},"677b":function(e,r,t){"use strict";(function(e){var n=t("47a9");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(t("7eb4")),c=n(t("7ca3")),u=n(t("ee10")),o=t("8f59"),l=(n(t("77a5")),t("cc12")),i=t("d468");function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function g(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach((function(r){(0,c.default)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var h={name:"index",components:{MgImg:function(){t.e("components/common/my-img").then(function(){return resolve(t("ce34"))}.bind(null,t)).catch(t.oe)},mgAgree:function(){t.e("components/form/my-agree").then(function(){return resolve(t("962a"))}.bind(null,t)).catch(t.oe)},mgRtext:function(){Promise.all([t.e("common/vendor"),t.e("components/common/functionCmp/rich-text")]).then(function(){return resolve(t("248b"))}.bind(null,t)).catch(t.oe)},Pay:function(){Promise.all([t.e("common/vendor"),t.e("components/pay/pay")]).then(function(){return resolve(t("1e12"))}.bind(null,t)).catch(t.oe)},sqBtn:function(){Promise.all([t.e("common/vendor"),t.e("components/common/sq-btn")]).then(function(){return resolve(t("c52b"))}.bind(null,t)).catch(t.oe)}},data:function(){return{aIdx:0,focus:!1,rule:{list:[]},xzrule:{},money:"",loading:!1,isAgree:!1,params:{id:""},storeInfo:{},storeId:""}},onLoad:function(){var e=this;return(0,u.default)(a.default.mark((function r(){return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.util.setNT(e.$t("recharge.membership_stored_value")),e.gDw(),e.init();case 3:case"end":return r.stop()}}),r)})))()},onShow:function(){var r=this;return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getStorageSync("rStoreInfo")&&(r.storeInfo=e.getStorageSync("rStoreInfo"),r.load(r.storeInfo.id));case 1:case"end":return t.stop()}}),t)})))()},mixins:[i.utilMixins],computed:g(g({},(0,o.mapState)({recharge:function(e){return e.config.storageVal}})),(0,o.mapState)(["sjxx"])),methods:g(g({},(0,o.mapActions)(["getConfig","getSjxx"])),{},{init:function(){var r=this;return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.getLoginInfo();case 2:return t.next=4,r.getLayout();case 4:return t.next=6,r.getConfig({ident:["storageVal"]}).then((function(){r.isload=!0,1!=r.recharge.state&&e.showModal({title:r.$t("recharge.tip"),content:r.$t("recharge.stored_value_function_is_closed"),showCancel:!1,confirmText:r.$t("modal.confirm"),success:function(e){r.go({t:6,url:"/pages/index/my-index"})}})}));case 6:r.rechargeRule();case 7:case"end":return t.stop()}}),t)})))()},load:function(r){return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r&&e.removeStorageSync("rStoreInfo");case 1:case"end":return t.stop()}}),t)})))()},gDw:function(){var e=this;return(0,u.default)(a.default.mark((function r(){var t,n;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.storeInfo||!e.storeInfo.id){r.next=4;break}return r.abrupt("return");case 4:return r.next=6,(0,l.getDw)({t:0});case 6:return t=r.sent,e.lc=t,r.next=10,e.getAddInfo(t);case 10:return r.next=12,e.util.request({url:e.api.dplb,data:{lat:t.latitude||"",lng:t.longitude||"",recharge:1}});case 12:n=r.sent,e.storeInfo=n.data&&n.data.list&&n.data.list[0];case 14:case"end":return r.stop()}}),r)})))()},goSelect:function(){e.navigateTo({url:"/pages/shop/select/index?page=recharge"})},rechargeRule:function(){var e=this;return(0,u.default)(a.default.mark((function r(){var t,n;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.refreshUser({get:1,now:1}),r.next=3,e.util.request({url:e.api.czgz});case 3:t=r.sent,n=t.data,e.rule.list=n,n.length&&(e.aIdx=0,e.xzrule=n[0]);case 7:case"end":return r.stop()}}),r)})))()},change:function(e){this.aIdx=e,-1==e?this.focus=!0:(this.focus=!1,this.xzrule=this.rule.list[e])},save:function(){var e=this;return(0,u.default)(a.default.mark((function r(){var t,n,c;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.isLogin){r.next=3;break}return e.$refs["sqBtn"].open(),r.abrupt("return");case 3:if(e.isAgree){r.next=6;break}return e.util.message(e.$t("recharge.please_read_and_agree_to_the_membership_stored_value_agreement_carefully"),3,2e3),r.abrupt("return");case 6:if(t=-1==e.aIdx?+e.money:e.xzrule.amount,n=-1==e.aIdx?0:e.rule.list[e.aIdx].id,t){r.next=11;break}e.util.message(e.$t("recharge.please_enter_the_stored_value_amount"),3),r.next=20;break;case 11:if(!(-1==e.aIdx&&t<+e.recharge.minPrice)){r.next=15;break}e.util.message(e.$t("recharge.minimum_recharge_amount")+e.recharge.minPrice,3),r.next=20;break;case 15:return e.loading=!0,r.next=18,e.util.request({url:e.api.czgz,method:"POST",mask:e.$t("recharge.placing_order"),data:{money:t,storeId:e.storeInfo&&e.storeInfo.id,id:n}});case 18:c=r.sent,c?(e.$refs["Pay"].czOpen(JSON.stringify({orderSn:c.data.orderSn,orderType:2,go:{t:6,url:"/pages/other/recharge/index"}})),e.loading=!1):e.loading=!1;case 20:case"end":return r.stop()}}),r)})))()},goDhm:function(){this.go({url:"/pages/other/coupon/dhm?type=2",t:1})}})};r.default=h}).call(this,t("df3c")["default"])},"981a":function(e,r,t){"use strict";t.r(r);var n=t("677b"),a=t.n(n);for(var c in n)["default"].indexOf(c)<0&&function(e){t.d(r,e,(function(){return n[e]}))}(c);r["default"]=a.a},e088:function(e,r,t){"use strict";t.d(r,"b",(function(){return a})),t.d(r,"c",(function(){return c})),t.d(r,"a",(function(){return n}));var n={pay:function(){return Promise.all([t.e("common/vendor"),t.e("components/pay/pay")]).then(t.bind(null,"1e12"))}},a=function(){var e=this,r=e.$createElement,t=(e._self._c,e.recharge&&1==e.recharge.state?e.$t("recharge.account_balance"):null),n=e.recharge&&1==e.recharge.state&&e.isLogin?e.user.account&&parseFloat(e.user.account.balance):null,a=e.recharge&&1==e.recharge.state?e.$t("recharge.transaction_record"):null,c=e.recharge&&1==e.recharge.state?e.$t("recharge.stored_value_exchange"):null,u=e.recharge&&1==e.recharge.state?e.__map(e.rule.list,(function(r,t){var n=e.__get_orig(r),a=e.aIdx==t?e.cTR(e.tColor):null,c=Number(r.amount),u=r.rule.balanceSwitch&&1==r.rule.balanceSwitch?e.$t("recharge.gift"):null,o=r.rule.balanceSwitch&&1==r.rule.balanceSwitch?e.$t("recharge.balance"):null,l=r.rule.balanceSwitch&&1==r.rule.balanceSwitch||1!=r.rule.integralSwitch?null:e.$t("recharge.gift"),i=r.rule.balanceSwitch&&1==r.rule.balanceSwitch||1!=r.rule.integralSwitch?null:e.$t("recharge.points"),s=e.aIdx==t&&0==r.first?e.$t("recharge.first_recharge_reward"):null;return{$orig:n,m4:a,m5:c,m6:u,m7:o,m8:l,m9:i,m10:s}})):null,o=e.recharge&&1==e.recharge.state&&1==e.recharge.topUpPrice&&-1==e.aIdx?e.cTR(e.tColor):null,l=e.recharge&&1==e.recharge.state&&1==e.recharge.topUpPrice?e.$t("recharge.please_enter"):null,i=e.recharge&&1==e.recharge.state&&1==e.recharge.topUpPrice?e.$t("recharge.other_amount"):null,s=e.recharge&&1==e.recharge.state&&e.aIdx>=0?e.$t("recharge.you_will_get"):null,g=e.recharge&&1==e.recharge.state&&e.aIdx>=0&&e.xzrule.rule.balanceSwitch&&1==e.xzrule.rule.balanceSwitch?e.$t("recharge.give"):null,h=e.recharge&&1==e.recharge.state&&e.aIdx>=0&&e.xzrule.rule.balanceSwitch&&1==e.xzrule.rule.balanceSwitch?e.$t("recharge.balance"):null,f=e.recharge&&1==e.recharge.state&&e.aIdx>=0&&1==e.xzrule.rule.integralSwitch?e.$t("recharge.give"):null,d=e.recharge&&1==e.recharge.state&&e.aIdx>=0&&1==e.xzrule.rule.integralSwitch?e.$t("recharge.points"):null,m=e.recharge&&1==e.recharge.state&&e.aIdx>=0&&1==e.xzrule.rule.couponSwitch?e.$t("recharge.give"):null,p=e.recharge&&1==e.recharge.state&&e.aIdx>=0&&1==e.xzrule.rule.levelSwitch?e.$t("recharge.upgrade_to_membership_level"):null,b=e.recharge&&1==e.recharge.state?e.$t("recharge.instructions"):null,x=e.recharge&&1==e.recharge.state?e.$t("recharge.membership_stored_value_agreement"):null,v=e.recharge&&1==e.recharge.state?e.$t("recharge.store_value_now"):null;e.$mp.data=Object.assign({},{$root:{m0:t,m1:n,m2:a,m3:c,l0:u,m11:o,m12:l,m13:i,m14:s,m15:g,m16:h,m17:f,m18:d,m19:m,m20:p,m21:b,m22:x,m23:v}})},c=[]},ebe3:function(e,r,t){"use strict";(function(e,r){var n=t("47a9");t("b483");n(t("3240"));var a=n(t("1fc2"));e.__webpack_require_UNI_MP_PLUGIN__=t,r(a.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])}},[["ebe3","common/runtime","common/vendor"]]]);