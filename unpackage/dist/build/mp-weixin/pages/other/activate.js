(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/other/activate"],{"12d1":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,a=(e._self._c,e.user.vipCard?null:e.cTR(e.tColor)),r=e.user.vipCard?null:e.$t("chooseAvatar.membership_card"),n=e.$t("chooseAvatar.user_nickname"),s=e.$t("chooseAvatar.enter_user_nickname"),o=e.$t("chooseAvatar.mobile_number"),i=e.$t("chooseAvatar.enter_mobile"),u=e.isuserMobile?null:e.$t("chooseAvatar.requestopt"),c=e.isuserMobile||e.time<=0?null:e.$t("sq-btn.sent"),l=e.isuserMobile?null:e.$t("chooseAvatar.enteropt"),d=e.isuserMobile?null:e.$t("chooseAvatar.enter_code"),f=e.$t("chooseAvatar.email"),m=e.$t("chooseAvatar.enter_email"),h=e.$t("chooseAvatar.real_name"),p=e.$t("chooseAvatar.enter_realName"),b=e.$t("chooseAvatar.gender"),g=e.$t("chooseAvatar.birthday"),v=e.params.birthday||e.$t("chooseAvatar.birthday_once_modified")+"，"+e.$t("chooseAvatar.cannot_edit_again"),w=e.$t("chooseAvatar.claim_card");e.$mp.data=Object.assign({},{$root:{m0:a,m1:r,m2:n,m3:s,m4:o,m5:i,m6:u,m7:c,m8:l,m9:d,m10:f,m11:m,m12:h,m13:p,m14:b,m15:g,m16:v,m17:w}})},n=[]},"2d34":function(e,t,a){"use strict";(function(e,t){var r=a("47a9");a("b483");r(a("3240"));var n=r(a("822f"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(n.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])},"2d6f":function(e,t,a){},"7d25":function(e,t,a){"use strict";(function(e){var r=a("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("7eb4")),s=r(a("7ca3")),o=r(a("ee10")),i=a("8f59"),u=r(a("77a5")),c=r(a("5137")),l=a("d468"),d=a("e19d");function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={components:{sqBtn:function(){Promise.all([a.e("common/vendor"),a.e("components/common/sq-btn")]).then(function(){return resolve(a("c52b"))}.bind(null,a)).catch(a.oe)},mgRadio:function(){a.e("components/form/my-radio").then(function(){return resolve(a("2c44"))}.bind(null,a)).catch(a.oe)}},name:"chooseAcatar",data:function(){return{loading:!1,avatarUrl:"https://thirdwx.qlogo.cn/mmopen/vi_32/POgEwh4mIHO4nibH0KlMECNjjGxQUq24ZEaGT4poC6icRiccVGKSyXwibcPq4BWmiaIGuG1icwxaQX6grC9VemZoJ8rg/132",baseData:"",nickname:"",userId:"",userMobile:"",isuserMobile:!1,email:"",time:0,btntxt:this.$t("chooseAvatar.send_verification_code"),isSending:!1,params:{userId:"",userTel:"",email:"",birthday:"2000-01-01",sex:this.$t("chooseAvatar.male"),realName:"",createdAt:""},sexArr:[{value:1,name:this.$t("chooseAvatar.male")},{value:2,name:this.$t("chooseAvatar.female"),checked:"true"}],birthday:""}},onLoad:function(t){var a=this;return(0,o.default)(n.default.mark((function r(){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.util.setNT(a.$t("chooseAvatar.personal_info")),r.next=3,a.getLoginInfo();case 3:if(!t||!t.linetype){r.next=8;break}return r.next=6,a.iniline();case 6:r.next=12;break;case 8:return r.next=10,a.checkLogin();case 10:if(r.sent){r.next=12;break}return r.abrupt("return");case 12:a.user.vipCard&&e.reLaunch({url:"/pages/my/vip/wkk"}),a.user&&(a.avatarUrl=a.user.avatar,a.nickname=a.user.nickname,a.userId=a.user.id,a.user.mobile&&a.user.mobile.length>0&&(a.userMobile=a.user.mobile,a.isuserMobile=!0),a.params.userTel=a.user.mobile,a.params.email=a.user.email,a.params.realName=a.user.realName,a.params.sex=a.user.sex?a.user.sex:1,a.user.birthday&&a.isValidDateTime(a.user.birthday)&&(console.log("1--12",a.user.birthday),a.params.birthday=a.user.birthday,a.birthday=a.user.birthday)),a.getConfig({ident:["basicSetting","birthdayGift"]});case 15:case"end":return r.stop()}}),r)})))()},computed:m(m({},(0,i.mapState)({system:function(e){return e.system},birthdayGift:function(e){return e.config.birthdayGift}})),{},{hToken:function(){return"Bearer ".concat(e.getStorageSync("token"))},appType:function(){return c.default.platform},startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}}),mixins:[l.utilMixins],methods:m(m(m({},(0,i.mapActions)(["getConfig"])),(0,i.mapMutations)(["setMobile","setToken","setUser"])),{},{iniline:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var a,r,s,i;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("getLoginInfo");case 2:a=e,e.$store.state.isLogin||(r=getCurrentPages().pop(),s="/".concat(r.route).concat(r.options?"?"+Object.keys(r.options).map((function(e){return"".concat(e,"=").concat(r.options[e])})).join("&"):""),console.log(s),console.log(getApp().globalData.siteInfo.siteroot),"".concat(getApp().globalData.siteInfo.siteroot,"/h5/#").concat(s),i=getApp().globalData.siteInfo.liffId,a=e,(0,d.loadLineSDK)(i).then(function(){var e=(0,o.default)(n.default.mark((function e(t){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t.isLoggedIn()),!t){e.next=7;break}if(!t.isLoggedIn()){e.next=6;break}return e.abrupt("return",t.getProfile());case 6:return e.abrupt("return",t.login({redirectUri:window.location.href}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var e=(0,o.default)(n.default.mark((function e(t){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t||!t.userId){e.next=3;break}return e.next=3,a.linelogin(t.userId,t.displayName);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e)})));case 4:case"end":return t.stop()}}),t)})))()},linelogin:function(e,t){var a=this;return(0,o.default)(n.default.mark((function r(){var s;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.util.request({url:a.api.lineLogin,method:"post",data:{id:e,name:t}});case 2:s=r.sent,s.data&&(a.$store.commit("setUser",s.data.userInfo),a.$store.commit("setToken",s.data.token));case 4:case"end":return r.stop()}}),r)})))()},onChooseAvatar:function(e){console.log("e",e),this.avatarUrl=e.detail.avatarUrl},isValidDateTime:function(e){var t=new Date(e);return t instanceof Date&&!isNaN(t)},onInput:function(e){console.log(e),this.nickname=e.detail.value},sqsjh:function(){this.$refs["sqBtn"].open()},bindDateChange:function(e){var t=this;return(0,o.default)(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:console.log(e),t.params.birthday=e.target.value;case 2:case"end":return a.stop()}}),a)})))()},getDate:function(e){var t=new Date,a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate();return"start"===e?a-=60:"end"===e&&(a+=2),r=r>9?r:"0"+r,n=n>9?n:"0"+n,"".concat(a,"-").concat(r,"-").concat(n)},timer:function(){this.time>0?(this.time--,this.btntxt=this.time+this.$t("sq-btn.seconds"),setTimeout(this.timer,1e3)):(this.time=0,this.btntxt=this.$t("sq-btn.send_verification_code"))},sendcode:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var a,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.params.userTel.length<7)){t.next=2;break}return t.abrupt("return",e.util.message(e.$t("registration.enter_phone_number"),3));case 2:return a=e.params.userTel,a=e.params.userTel.startsWith("+66")?e.params.userTel:e.params.userTel.startsWith("66")?"+66"+e.params.userTel.slice(2):"+66"+e.params.userTel,e.isSending=!0,t.next=7,e.util.request({url:e.api.sendRegisterCode,method:"POST",mask:e.$t("password_reset.sending"),data:{phone:a,type:1}});case 7:r=t.sent,e.isSending=!1,console.log("1212",r),r&&200==r.code&&(e.time=60,e.timer());case 11:case"end":return t.stop()}}),t)})))()},cmb:function(t){var a=this;return(0,o.default)(n.default.mark((function r(){var s,i,c;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log("mpGetphonenumber",t),"getPhoneNumber:ok"!=t.detail.errMsg){r.next=8;break}a.loading=!0,s=getApp().globalData.session_key,i=t.detail.encryptedData,c=t.detail.iv,a.util.request({url:a.api.jm,method:"POST",data:{sessionKey:s,data:i,iv:c}}).then(function(){var t=(0,o.default)(n.default.mark((function t(r){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a.loading=!1,!r.data.phoneNumber){t.next=9;break}return a.setMobile(r.data.phoneNumber),e.setStorageSync("userTel",r.data.phoneNumber),t.next=6,a.util.request({url:a.api.gxmb,method:"post",data:{mobile:r.data.phoneNumber}}).then(function(){var e=(0,o.default)(n.default.mark((function e(t){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("rest",t),a.setToken(t.data.token),a.setUser(t.data.userInfo),a.util.message(t.msg||a.$t("chooseAvatar.registration_successful"),1,1e3),u.default.swnb(1e3);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){a.loading=!1}));case 6:t.sent,t.next=10;break;case 9:console.log(r);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){a.loading=!1})),console.log(s,i,c),r.next=11;break;case 8:return a.loading=!1,e.showModal({title:a.$t("chooseAvatar.warm_reminder"),content:a.$t("chooseAvatar.authorized_mobile_number_failed"),showCancel:!1,confirmText:i18n.t("modal.confirm")}),r.abrupt("return");case 11:case"end":return r.stop()}}),r)})))()},goLogin:function(){var t=this;return(0,o.default)(n.default.mark((function a(){var r;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.params.userTel){a.next=3;break}return t.util.message(t.$t("chooseAvatar.please_authorize_mobile_number"),3,2e3),a.abrupt("return");case 3:if(t.params.birthday){a.next=6;break}return t.util.message(t.$t("chooseAvatar.please_birthday"),3,2e3),a.abrupt("return");case 6:return r=t.params.userTel,r=t.params.userTel.startsWith("+66")?t.params.userTel:t.params.userTel.startsWith("66")?"+66"+t.params.userTel.slice(2):"+66"+t.params.userTel,a.next=10,t.refreshUser({get:0,now:1,mobile:r,avatar:t.avatarUrl,nickname:t.nickname,realName:t.params.realName?t.params.realName:"",sex:t.params.sex,birthday:t.params.birthday,code:t.params.code,email:t.params.email});case 10:t.util.message(t.$t("chooseAvatar.modification_successful"),1,1e3),t.refreshUser({get:1,now:1}),e.reLaunch({url:"/pages/my/vip/wkk"});case 13:case"end":return a.stop()}}),a)})))()},outLogin:function(){var e=this;return(0,o.default)(n.default.mark((function t(){var a,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.modal(e.$t("chooseAvatar.confirm_logout"));case 2:return t.next=4,e.util.request({url:e.api.logout,method:"POST"});case 4:return a=t.sent,r=a.msg,e.util.message(r,1,1e3),t.next=9,e.setUser({id:"",mobile:""});case 9:return t.next=11,e.setToken("");case 11:e.getLoginInfo(),u.default.swnb(1e3);case 13:case"end":return t.stop()}}),t)})))()},handleAvatarSuccess2:function(e){this.avatarUrl=e.data},ckxz:function(){this.go({t:1,url:"/pages/my/other/gywm?t=活动说明&p=7"})},ckzl:function(){this.go({t:1,url:"/pages/my/other/gywm?t=活动说明&p=8"})},djsr:function(){this.util.message(this.$t("chooseAvatar.birthday_cannot_be_modified"),3,2e3)}})};t.default=h}).call(this,a("df3c")["default"])},"822f":function(e,t,a){"use strict";a.r(t);var r=a("12d1"),n=a("bfde");for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("ec8c");var o=a("828b"),i=Object(o["a"])(n["default"],r["b"],r["c"],!1,null,"c471305e",null,!1,r["a"],void 0);t["default"]=i.exports},bfde:function(e,t,a){"use strict";a.r(t);var r=a("7d25"),n=a.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(s);t["default"]=n.a},ec8c:function(e,t,a){"use strict";var r=a("2d6f"),n=a.n(r);n.a}},[["2d34","common/runtime","common/vendor"]]]);