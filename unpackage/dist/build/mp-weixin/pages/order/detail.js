(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/detail"],{"308d":function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("b483");r(n("3240"));var o=r(n("440c"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"440c":function(e,t,n){"use strict";n.r(t);var r=n("4464"),o=n("c98a");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("4859");var c=n("828b"),i=Object(c["a"])(o["default"],r["b"],r["c"],!1,null,"04a86138",null,!1,r["a"],void 0);t["default"]=i.exports},4464:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r}));var r={pay:function(){return Promise.all([n.e("common/vendor"),n.e("components/pay/pay")]).then(n.bind(null,"1e12"))}},o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$t("order-detail.order_details")),r=Object.keys(e.order).length,o=r>0?e.swiper&&e.swiper.imgUrl.length:null,a=r>0&&e.order.diningType<=3?e.$t("order-detail.if_refund_needed"):null,c=r>0&&e.order.diningType<=3?e.$t("order-detail.please_call_store"):null;e._isMounted||(e.e0=function(t){return e.util.makeTel(e.order.store.storeMobile)}),e.$mp.data=Object.assign({},{$root:{m0:n,g0:r,g1:o,m1:a,m2:c}})},a=[]},4859:function(e,t,n){"use strict";var r=n("cea9"),o=n.n(r);o.a},c857:function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("7eb4")),a=r(n("ee10")),c=r(n("7ca3")),i=n("8f59"),u=r(n("77a5"));function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,c.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={components:{dlBtn:function(){Promise.all([n.e("common/vendor"),n.e("pages/order/components/o-btn")]).then(function(){return resolve(n("a60f"))}.bind(null,n)).catch(n.oe)},dlDiscount:function(){n.e("pages/order/components/o-discount").then(function(){return resolve(n("f2b6"))}.bind(null,n)).catch(n.oe)},dlInfo:function(){n.e("pages/order/components/o-info").then(function(){return resolve(n("628a"))}.bind(null,n)).catch(n.oe)},Pay:function(){Promise.all([n.e("common/vendor"),n.e("components/pay/pay")]).then(function(){return resolve(n("1e12"))}.bind(null,n)).catch(n.oe)},picLunboBy:function(){n.e("components/drag/picLunbo").then(function(){return resolve(n("7630"))}.bind(null,n)).catch(n.oe)},ConsumptionGift:function(){n.e("components/goods/consumption-gift").then(function(){return resolve(n("2ccd"))}.bind(null,n)).catch(n.oe)},Waiter:function(){n.e("components/pay-order/waiter").then(function(){return resolve(n("c3a5"))}.bind(null,n)).catch(n.oe)},dlInBtn:function(){n.e("pages/order/components/o-in-btn").then(function(){return resolve(n("ebcb"))}.bind(null,n)).catch(n.oe)},dlOutBtn:function(){n.e("pages/order/components/o-out-btn").then(function(){return resolve(n("6462"))}.bind(null,n)).catch(n.oe)},uniNavBar:function(){n.e("components/third/uni-nav-bar").then(function(){return resolve(n("c474"))}.bind(null,n)).catch(n.oe)}},data:function(){return{order:{},stime:"",swiper:{imgUrl:[],height:"260",circle:"30"}}},computed:s({},(0,i.mapState)({copywriting:function(e){return e.layout.copywriting},orderSetting:function(e){return e.config.orderSetting}})),onLoad:function(t){var n=this;return(0,a.default)(o.default.mark((function r(){var a,c;return o.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return"#000000"==n.fontColor||"#000"==n.fontColor?e.setNavigationBarColor({frontColor:"#000000"}):e.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:"#ffffff"}),console.log("options",t),r.next=4,n.getLoginInfo();case 4:return t&&t.id?n.orderId=t.id:t.q&&decodeURIComponent(t.q).indexOf("orderId")>-1?(a=decodeURIComponent(t.q),n.orderId=u.default.getUrlParams(a)["orderId"]):t.q&&decodeURIComponent(t.q).indexOf("id")>-1&&(c=decodeURIComponent(t.q),n.orderId=u.default.getUrlParams(c)["id"]),r.next=7,n.getInfo();case 7:n.getLayout(),n.gAd(),n.getConfig({ident:["orderSetting"]});case 10:case"end":return r.stop()}}),r)})))()},onShow:function(){this.orderId&&this.getInfo()},methods:s(s({},(0,i.mapActions)(["getConfig"])),{},{getInfo:function(){var e=this;return(0,a.default)(o.default.mark((function t(){var n,r,a,c,i,u;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:"".concat(e.api.wmxd,"/").concat(e.orderId),mask:e.$t("order-detail.loading"),data:{orderId:e.orderId}});case 2:if(n=t.sent,r=n.data,!r){t.next=22;break}if(e.order=r.subOrder,!(e.order.discountsPlus&&e.order.discountsPlus.length>0)){t.next=22;break}if(a=e.order.discountsPlus.reduce((function(e,t){return e+parseFloat(t.money)}),0),console.log(a),console.log(e.order.discountMoney),!(a>e.order.discountMoney)){t.next=22;break}console.log("12"),c=a-e.order.discountMoney,i=e.order.discountsPlus.length-1;case 14:if(!(i>=0)){t.next=22;break}if(u=parseFloat(e.order.discountsPlus[i].money),!(u>=c)){t.next=19;break}return e.order.discountsPlus[i].money=u-c,t.abrupt("break",22);case 19:i--,t.next=14;break;case 22:case"end":return t.stop()}}),t)})))()},gAd:function(){var e=this;return(0,a.default)(o.default.mark((function t(){var n,r,a;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:e.api.gglb,data:{location:4}});case 2:if(n=t.sent,r=n.data,r){for(a in r.banner)r.banner[a].url=r.banner[a].link;e.swiper={imgUrl:r.banner?r.banner:[],height:"260",circle:"30"}}case 5:case"end":return t.stop()}}),t)})))()},operation:function(e){var t=this;return(0,a.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:n.t0=e.t,n.next="ljzf"===n.t0?3:"qxdd"===n.t0?5:"sqtk"===n.t0?7:"qrsh"===n.t0?11:"insqxdd"===n.t0?13:"insqtk"===n.t0?15:"inwcdd"===n.t0?17:"zlyd"===n.t0?19:"jc"===n.t0?20:22;break;case 3:return t.$refs["Pay"].open(JSON.stringify({orderSn:e.co.orderSn,orderType:1})),n.abrupt("break",22);case 5:return t.rfddcz(t.$t("order-detail.confirm_cancel_order"),"qxdd",e.co.id),n.abrupt("break",22);case 7:return n.next=9,t.util.modal(t.$t("order-detail.confirm_apply_refund"));case 9:return t.go({t:1,url:"/pages/order/refunddl?id=".concat(e.co.orderSn,"&type=1")}),n.abrupt("break",22);case 11:return t.rfddcz(t.$t("order-detail.confirm_receipt"),"qrsh",e.co.id),n.abrupt("break",22);case 13:return t.rfddcz(t.$t("order-detail.confirm_cancel_order"),"insqxdd",e.co.id),n.abrupt("break",22);case 15:return t.rfddcz(t.$t("order-detail.confirm_apply_refund"),"insqtk",e.co.orderSn),n.abrupt("break",22);case 17:return t.rfddcz(t.$t("order-detail.confirm_complete_order"),"inwcdd",e.co.orderSn),n.abrupt("break",22);case 19:t.go({t:6,url:"/pages/index/goods"});case 20:return t.go({t:2,url:"/pages/shop/in/goods?tableId=".concat(e.co.table.id,"&addgood=1")}),n.abrupt("break",22);case 22:case"end":return n.stop()}}),n)})))()},openpay:function(){console.log("12"),this.go({t:1,url:"/pages/order/promptpay"})},rfddcz:function(e,t,n){var r=this;return(0,a.default)(o.default.mark((function a(){var c,i;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,r.util.modal(e);case 2:return o.next=4,r.util.request({url:"".concat(r.api[t],"/").concat(n),method:"POST"});case 4:c=o.sent,i=c.msg,r.util.message(i,1,1e3),r.getInfo();case 8:case"end":return o.stop()}}),a)})))()},pay:function(){this.getInfo()},callWaiter:function(){var e=this;return(0,a.default)(o.default.mark((function t(){var n,r;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.modal(e.$t("order-detail.confirm_call_waiter"));case 2:return t.next=4,e.util.request({url:"".concat(e.api.call,"/").concat(e.order.table.id)});case 4:n=t.sent,r=n.data,e.util.message(r,3,2e3);case 7:case"end":return t.stop()}}),t)})))()},handReturn:function(){this.go({t:5,url:"/pages/index/index"})}}),onPullDownRefresh:function(){var t=this;return(0,a.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showloading=!0,n.next=3,t.getInfo();case 3:t.showloading=!1,e.stopPullDownRefresh();case 5:case"end":return n.stop()}}),n)})))()}};t.default=l}).call(this,n("df3c")["default"])},c98a:function(e,t,n){"use strict";n.r(t);var r=n("c857"),o=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);t["default"]=o.a},cea9:function(e,t,n){}},[["308d","common/runtime","common/vendor"]]]);