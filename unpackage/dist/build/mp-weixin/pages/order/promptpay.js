(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/promptpay"],{"10d8":function(t,e,n){"use strict";n.r(e);var r=n("be41"),o=n("2d03");for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("af78");var i=n("828b"),c=Object(i["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);e["default"]=c.exports},"2d03":function(t,e,n){"use strict";n.r(e);var r=n("65a2"),o=n.n(r);for(var a in r)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e["default"]=o.a},"45d1":function(t,e,n){},"65a2":function(t,e,n){"use strict";var r=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;r(n("77a5")),r(n("5137"));var o={data:function(){return{order:{},imagesrc:"",orderSn:"",orderType:0,payId:0,timer:null,checkPaymentTimer:null,totalTime:627}},onLoad:function(t){t&&t.orderSn&&(this.orderSn=t.orderSn),t&&t.orderType&&(this.orderType=t.orderType),t&&t.payId&&(this.payId=t.payId),console.log("1212",this.orderSn),this.orderSn&&(this.getorder(),this.promptpay())},computed:{minutes:function(){return Math.floor(this.totalTime/60)},seconds:function(){return this.totalTime%60}},onShow:function(){this.startCountdown(),this.startCheckPayment()},onHide:function(){this.clearCountdown(),this.clearCheckPayment()},onUnload:function(){this.clearCountdown(),this.clearCheckPayment()},methods:{startCountdown:function(){var t=this;this.timer=setInterval((function(){t.totalTime>0?t.totalTime--:t.cancelOrder()}),1e3)},clearCountdown:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},cancelOrder:function(){this.clearCountdown(),console.log("订单已取消")},promptpay:function(){var t=this;if(this.orderSn){var e={orderSn:this.orderSn,orderType:this.orderType,payId:this.payId};this.util.request({url:this.api.orderPay,method:"POST",mask:1,data:e}).then((function(e){e&&(console.log(e),e.data.imgdat||t.go({t:6,url:"/pages/index/order-index"}),t.imagesrc=e.data.imgdat)}))}},startCheckPayment:function(){var t=this;this.checkPaymentTimer=setInterval((function(){t.checkPaymentStatus()}),3e3)},clearCheckPayment:function(){this.checkPaymentTimer&&(clearInterval(this.checkPaymentTimer),this.checkPaymentTimer=null)},getorder:function(){var t=this;this.util.request({url:"".concat(this.api.pay,"/").concat(this.orderSn)}).then((function(e){console.log(e),e&&(t.order=e.data,console.log(t.order))}))},checkPaymentStatus:function(){var t=this;this.util.request({url:"".concat(this.api.pQuery,"/").concat(this.orderSn)}).then((function(e){console.log("1212",e),e&&e&&e.data.state>=2&&t.go({t:6,url:"/pages/index/order-index"})}))}}};e.default=o},af78:function(t,e,n){"use strict";var r=n("45d1"),o=n.n(r);o.a},be41:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){}));var r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.$t("promptpay.payment_info")),r=t.$t("promptpay.time_left"),o=t.$t("promptpay.minutes"),a=t.$t("promptpay.seconds"),i=t.$t("promptpay.scan_to_pay"),c=t.$t("promptpay.auto_redirect"),s=t.$t("promptpay.note");t.$mp.data=Object.assign({},{$root:{m0:n,m1:r,m2:o,m3:a,m4:i,m5:c,m6:s}})},o=[]},f38c:function(t,e,n){"use strict";(function(t,e){var r=n("47a9");n("b483");r(n("3240"));var o=r(n("10d8"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])}},[["f38c","common/runtime","common/vendor"]]]);